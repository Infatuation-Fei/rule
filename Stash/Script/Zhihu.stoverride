name: çŸ¥ä¹ğŸ¥
desc: å»å¹¿å‘ŠåŠé˜…è¯»ä½“éªŒå¢å¼º,é€‚é…çŸ¥ä¹8.3.0(8020)

http:
  mitm:
    - "www.zhihu.com"
    - "api.zhihu.com"
    - "zhuanlan.zhihu.com"
    - "appcloud2.zhihu.com"
    - "103.41.167.236"
    - "103.41.167.234"
    - "103.41.167.235"
    - "103.41.167.226"
  rewrite:
    # å±è”½çŸ¥ä¹ä¸‹å‘çš„é…ç½®ï¼Œå¦‚çš®è‚¤ç­‰
    - ^https?:\/\/api\.zhihu\.com\/ab\/api\/v1\/products\/zhihu\/platforms\/ios\/config - reject
    # å±è”½çŸ¥ä¹â€œæˆ‘çš„â€é¡µé¢æ¨èå¼€é€šä¼šå‘˜çš„å¡ç‰‡
    - ^https?:\/\/api\.zhihu\.com\/people\/self\/new_user_card - reject
    # çŸ¥ä¹å»é™¤å›ç­”ä¸‹çš„å¹¿å‘Š
    - ^https?:\/\/www\.zhihu\.com\/api\/v4\/answers\/\d+\/recommendations - reject
  script:
   # çŸ¥ä¹_å¤„ç†ç”¨æˆ·ä¿¡æ¯
    - match: ^https?:\/\/api\.zhihu\.com\/people\/
      name: zhihu
      type: response
      require-body: true
      timeout: 10
   # çŸ¥ä¹_ä¿¡æ¯æµå»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/(moments|topstory)(\/|\?)?(recommend|action=|feed_type=)(?!\/people)
      name: zhihu
      type: response
      require-body: true
      timeout: 10   
   # çŸ¥ä¹_è·å–é»‘åå•
    - match: ^https?:\/\/api\.zhihu\.com\/settings\/blocked_users
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_å®˜æ–¹æ¶ˆæ¯å»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/notifications\/v3\/(message|timeline\/entry\/system_message)
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_é¢„ç½®å…³é”®è¯å»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/search\/preset_words\?
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_å›ç­”åˆ—è¡¨å»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/v4\/questions
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_å›ç­”å†…å®¹ä¼˜åŒ–
    - match: ^https?:\/\/www\.zhihu\.com\/appview\/v2\/answer\/.*(entry=(?!(preload-topstory|preload-search|preload-subscription)))?
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_ä¼˜åŒ–è½¯ä»¶é…ç½®
    - match: ^https?:\/\/appcloud2\.zhihu\.com\/v\d+\/config
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_çƒ­æœå»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/search\/top_search\/tabs\/hot\/items
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_çƒ­æ¦œå»å¹¿å‘Š2
    - match: ^https?:\/\/api\.zhihu\.com\/topstory\/hot-lists?(\?|\/)
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_è¯„è®ºå»å¹¿å‘Š
    - match: ^https?:\/\/api\.zhihu\.com\/(comment_v5\/)?(answers|comments?|articles|pins)\/\d+\/(root_|child_)?comments?
      name: zhihu
      type: response
      require-body: true
      timeout: 10 
   # çŸ¥ä¹_è§£é”å…³é”®è¯å±è”½
    - match: ^https?:\/\/api\.zhihu\.com\/feed-root\/block
      name: zhihu
      type: request
      require-body: true
      timeout: 10 
      
script-providers:
  zhihu:
    url: https://gist.githubusercontent.com/blackmatrix7/2e550ebf28ca60d620654e394ec47e0b/raw/zhihu.js
    interval: 86400

rules:
  - DOMAIN,118.89.204.198,REJECT
  # çŸ¥ä¹å»å¹¿å‘Š
  - IP-CIDR,118.89.204.198/32,REJECT,no-resolve
  - IP-CIDR6,2402:4e00:1200:ed00:0:9089:6dac:96b6/128,REJECT,no-resolve
  - DOMAIN,appcloud2.in.zhihu.com,REJECT
  - DOMAIN,mqtt.zhihu.com,REJECT
  - DOMAIN,sugar.zhihu.com,REJECT
  - USER-AGENT,AVOS*,REJECT
  # æ‹¦æˆªçŸ¥ä¹å¼€å±å¹¿å‘Š
  - URL-REGEX,^https?:\/\/api\.zhihu\.com\/commercial_api\/launch_v2\?,REJECT
  # æ‹¦æˆªçŸ¥ä¹å“ç‰Œæé—®å¹¿å‘Š
  - URL-REGEX,^https?:\/\/api\.zhihu\.com\/brand\/question\/\d+/card\?,REJECT
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v\d+\/brand\/question/\d+/card\?,REJECT
  # æ‹¦æˆªçŸ¥ä¹å›ç­”ä¸‹çš„å¹¿å‘Š
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v4\/answers\/\d+\/recommendations,REJECT
  # çŸ¥ä¹æ‹¦æˆªéƒ¨åˆ†é¢„åŠ è½½
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/appview\/(p|v2\/answer|zvideo)\/.*entry=(preload-topstory|preload-search|preload-subscription),REJECT
  # çŸ¥ä¹ç½‘é¡µç‰ˆå»å¹¿å‘Š
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v4/(questions|anwsers)\/\d+/related-readings,REJECT
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v4\/hot_recommendation,REJECT
  - URL-REGEX,^https?:\/\/www\.zhihu\.com\/commercial_api\/banners_v3\/mobile_banner,REJECT
  - URL-REGEX,^https?:\/\/zhuanlan\.zhihu\.com\/api\/articles\/\d+\/recommendation,REJECT
